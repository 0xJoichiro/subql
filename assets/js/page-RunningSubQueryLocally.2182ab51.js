(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{508:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/de/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"using-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-dictionary"}},[e._v("#")]),e._v(" Using a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/de/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-mode"}},[e._v("#")]),e._v(" Local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/de/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},538:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/es/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"using-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-dictionary"}},[e._v("#")]),e._v(" Using a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/es/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-mode"}},[e._v("#")]),e._v(" Local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/es/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},598:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/it/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"using-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-dictionary"}},[e._v("#")]),e._v(" Using a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/it/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-mode"}},[e._v("#")]),e._v(" Local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/it/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},628:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/ja/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"using-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-dictionary"}},[e._v("#")]),e._v(" Using a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/ja/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-mode"}},[e._v("#")]),e._v(" Local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/ja/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},712:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service.\nDon't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing.\nTo find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"use-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-a-dictionary"}},[e._v("#")]),e._v(" Use a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("RouterLink",{attrs:{to:"/tutorials_examples/dictionary.html"}},[e._v("Read more about how a SubQuery Dictionary works")]),e._v(".")],1),e._v(" "),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"run-in-local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-in-local-mode"}},[e._v("#")]),e._v(" Run in local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h4",{attrs:{id:"check-your-node-health"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-your-node-health"}},[e._v("#")]),e._v(" Check your node health")]),e._v(" "),s("p",[e._v("There are 2 endpoints that you can use to check and monitor the health of a running SubQuery node.")]),e._v(" "),s("ul",[s("li",[e._v("Health check endpoint that returns a simple 200 response")]),e._v(" "),s("li",[e._v("Metadata endpoint that includes additional analytics of your running SubQuery node")])]),e._v(" "),s("p",[e._v("Append this to the base URL of your SubQuery node. Eg "),s("code",[e._v("http://localhost:3000/meta")]),e._v(" will return:")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"currentProcessingHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000699")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"currentProcessingTimestamp"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1631517883547")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"targetHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6807295")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"bestHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6807298")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"indexerNodeVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.19.1"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lastProcessedHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000699")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lastProcessedTimestamp"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1631517883555")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"uptime"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("41.151789063")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"polkadotSdkVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"5.4.1"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"apiConnected"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" true,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"injectedApiConnected"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" true,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"usingDictionary"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" false,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"chain"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Polkadot"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"specName"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"polkadot"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"genesisHash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x91b171bb158e2d3848fa23a9f1c25182fb8e20313b2c1eb49219da7a70ce90c3"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"blockTime"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6000")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br")])]),s("p",[s("code",[e._v("http://localhost:3000/health")]),e._v(" will return HTTP 200 if successful.")]),e._v(" "),s("p",[e._v("A 500 error will be returned if the indexer is not healthy. This can often be seen when the node is booting up.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"status"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("500")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"error"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Indexer is not healthy"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("If an incorrect URL is used, a 404 not found error will be returned.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"statusCode"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("404")]),e._v(",\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"message"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Cannot GET /healthy"')]),e._v(",\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"error"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Not Found"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("h4",{attrs:{id:"debug-your-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debug-your-project"}},[e._v("#")]),e._v(" Debug your project")]),e._v(" "),s("p",[e._v("Use the "),s("a",{attrs:{href:"https://nodejs.org/en/docs/guides/debugging-getting-started/",target:"_blank",rel:"noopener noreferrer"}},[e._v("node inspector"),s("OutboundLink")],1),e._v(" to run the following command.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("node --inspect-brk "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path to subql-node"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" -f "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path to subQuery project"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For example:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("node --inspect-brk /usr/local/bin/subql-node -f ~/Code/subQuery/projects/subql-helloworld/\nDebugger listening on ws://127.0.0.1:9229/56156753-c07d-4bbe-af2d-2c7ff4bcc5ad\nFor help, see: https://nodejs.org/en/docs/inspector\nDebugger attached.\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("Then open up the Chrome dev tools, go to Source > Filesystem and add your project to the workspace and start debugging. For more information, check out\n"),s("a",{attrs:{href:"https://doc.subquery.network/tutorials_examples/debug-projects/",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to debug a SubQuery project"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_HOST=localhost\nsubql-query --name <project_name> --playground\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},734:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/th/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"use-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-a-dictionary"}},[e._v("#")]),e._v(" Use a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/th/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("RouterLink",{attrs:{to:"/th/tutorials_examples/dictionary.html"}},[e._v("Read more about how a SubQuery Dictionary works")]),e._v(".")],1),e._v(" "),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"run-in-local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-in-local-mode"}},[e._v("#")]),e._v(" Run in local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h4",{attrs:{id:"check-your-node-health"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-your-node-health"}},[e._v("#")]),e._v(" Check your node health")]),e._v(" "),s("p",[e._v("There are 2 endpoints that you can use to check and monitor the health of a running SubQuery node.")]),e._v(" "),s("ul",[s("li",[e._v("Health check endpoint that returns a simple 200 response")]),e._v(" "),s("li",[e._v("Metadata endpoint that includes additional analytics of your running SubQuery node")])]),e._v(" "),s("p",[e._v("Append this to the base URL of your SubQuery node. Eg "),s("code",[e._v("http://localhost:3000/meta")]),e._v(" will return:")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"currentProcessingHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000699")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"currentProcessingTimestamp"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1631517883547")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"targetHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6807295")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"bestHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6807298")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"indexerNodeVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.19.1"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lastProcessedHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000699")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lastProcessedTimestamp"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1631517883555")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"uptime"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("41.151789063")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"polkadotSdkVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"5.4.1"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"apiConnected"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" true,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"injectedApiConnected"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" true,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"usingDictionary"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" false,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"chain"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Polkadot"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"specName"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"polkadot"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"genesisHash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x91b171bb158e2d3848fa23a9f1c25182fb8e20313b2c1eb49219da7a70ce90c3"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"blockTime"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6000")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br")])]),s("p",[s("code",[e._v("http://localhost:3000/health")]),e._v(" will return HTTP 200 if successful.")]),e._v(" "),s("p",[e._v("A 500 error will be returned if the indexer is not healthy. This can often be seen when the node is booting up.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"status"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("500")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"error"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Indexer is not healthy"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("If an incorrect URL is used, a 404 not found error will be returned.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"statusCode"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("404")]),e._v(",\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"message"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Cannot GET /healthy"')]),e._v(",\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"error"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Not Found"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("h4",{attrs:{id:"debug-your-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debug-your-project"}},[e._v("#")]),e._v(" Debug your project")]),e._v(" "),s("p",[e._v("Use the "),s("a",{attrs:{href:"https://nodejs.org/en/docs/guides/debugging-getting-started/",target:"_blank",rel:"noopener noreferrer"}},[e._v("node inspector"),s("OutboundLink")],1),e._v(" to run the following command.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("node --inspect-brk "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path to subql-node"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" -f "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path to subQuery project"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For example:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("node --inspect-brk /usr/local/bin/subql-node -f ~/Code/subQuery/projects/subql-helloworld/\nDebugger listening on ws://127.0.0.1:9229/56156753-c07d-4bbe-af2d-2c7ff4bcc5ad\nFor help, see: https://nodejs.org/en/docs/inspector\nDebugger attached.\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("Then open up the Chrome dev tools, go to Source > Filesystem and add your project to the workspace and start debugging. For more information, check out "),s("a",{attrs:{href:"https://doc.subquery.network/tutorials_examples/debug-projects/",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to debug a SubQuery project"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/th/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},763:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("Bu kılavuz, hem dizinleyiciyi hem de sorgu hizmetini içeren altyapınızda yerel bir SubQuery düğümünün nasıl çalıştırılacağı üzerinde çalışır. Kendi SubQuery altyapınızı çalıştırma konusunda endişelenmek istemiyor musunuz? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/tr/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"docker-ı-kullanma"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-ı-kullanma"}},[e._v("#")]),e._v(" Docker'ı kullanma")]),e._v(" "),s("p",[e._v("Alternatif bir çözüm, "),s("code",[e._v(">docker-compose.yml")]),e._v(" dosyası tarafından tanımlanan "),s("strong",[e._v("Docker Container")]),e._v(" çalıştırmaktır. Yeni başlanmış yeni bir proje için burada hiçbir şeyi değiştirmenize gerek kalmayacak.")]),e._v(" "),s("p",[e._v("Proje dizininin altında aşağıdaki komutu çalıştırın:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("Gerekli paketleri ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(" ve Postgres) ilk kez indirmek biraz zaman alabilir, ancak yakında çalışan bir SubQuery düğümü görürsünüz.")]),e._v(" "),s("h2",{attrs:{id:"dizinleyici-calıstırma-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dizinleyici-calıstırma-subql-node"}},[e._v("#")]),e._v(" Dizinleyici çalıştırma (subql/node)")]),e._v(" "),s("p",[e._v("Gereksinim -leri:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (sürüm 12 veya üstü). "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" blok zincirini dizine alırken, çıkarılan veriler harici bir veritabanı örneğinde depolanır.")])]),e._v(" "),s("p",[e._v("SubQuery düğümü, SubQuery projesi başına substrat tabanlı blok zinciri verilerini ayıklayan ve postgres veritabanına kaydeden bir uygulamadır.")]),e._v(" "),s("h3",{attrs:{id:"kurma"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kurma"}},[e._v("#")]),e._v(" Kurma")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Lütfen "),s("strong",[e._v("DO NOT")]),e._v(", zayıf bağımlılık yönetimi nedeniyle "),s("code",[e._v("yarn global")]),e._v(" kullanımını teşvik ettiğimizi ve bunun da bir hataya yol açabileceğini unutmayın.")]),e._v(" "),s("p",[e._v("Yüklendikten sonra, aşağıdaki komutla bir düğüm başlatabilirsiniz:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"anahtar-komutlar"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#anahtar-komutlar"}},[e._v("#")]),e._v(" Anahtar Komutlar")]),e._v(" "),s("p",[e._v("Aşağıdaki komutlar, bir SubQuery node yapılandırmasını tamamlamanıza ve dizine eksemeye başlamanıza yardımcı olur. Daha fazla şey öğrenmek için her zaman "),s("code",[e._v("--help")]),e._v(" çalıştırabilirsiniz.")]),e._v(" "),s("h4",{attrs:{id:"yerel-proje-yolunun-goster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yerel-proje-yolunun-goster"}},[e._v("#")]),e._v(" Yerel proje yolunun göster")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f proje-yolunuz\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"sozluk-kullanma"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sozluk-kullanma"}},[e._v("#")]),e._v(" Sözlük Kullanma")]),e._v(" "),s("p",[e._v("Tam zincir sözlüğü kullanmak, test sırasında veya ilk dizininiz sırasında bir SubQuery projesinin işlenmesini önemli ölçüde hızlandırabilir. Bazı durumlarda, 10 kata kadar endeksleme performansı artışları gördük.")]),e._v(" "),s("p",[e._v("Tam zincir sözlüğü, belirli bir zincir içindeki tüm olayların ve dışsal öğelerin konumunu önceden dizine dizine işaretler ve düğüm hizmetinizin her bloğu incelemek yerine dizine alırken ilgili konumlara atlamasını sağlar.")]),e._v(" "),s("p",[e._v("Sözlük uç noktasını "),s("code",[e._v("project.yaml")]),e._v(" dosyanıza ekleyebilirsiniz (bkz. "),s("RouterLink",{attrs:{to:"/tr/create/manifest.html"}},[e._v("Manifest File")]),e._v(") veya aşağıdaki komutu kullanarak çalışma zamanında belirtebilirsiniz:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("RouterLink",{attrs:{to:"/tr/tutorials_examples/dictionary.html"}},[e._v("Read more about how a SubQuery Dictionary works")]),e._v(".")],1),e._v(" "),s("h4",{attrs:{id:"veritabanına-baglanma"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#veritabanına-baglanma"}},[e._v("#")]),e._v(" Veritabanına bağlanma")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("dB_USER=postgres dışa aktarma\nDB_PASS=postgres dışa aktarma\ndışa aktarma DB_DATABASE=postgres\nDB_HOST=localhost ver\ndışa aktarma DB_PORT=5432\nsubql-node -f proje-yolunuz \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Postgres veritabanınızın yapılandırmasına (örneğin, farklı bir veritabanı parolası) bağlı olarak, lütfen hem dizin oluşturucunun ('subql/node') hem de sorgu hizmetinin ('subql/query') ona bir bağlantı kurabildiğinden emin olun.")]),e._v(" "),s("h4",{attrs:{id:"yapılandırma-dosyası-belirtme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yapılandırma-dosyası-belirtme"}},[e._v("#")]),e._v(" Yapılandırma dosyası belirtme")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c projeniz-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("Bu, query node YAML veya JSON biçiminde olabilecek bir yapılandırma dosyasına yönlendirecektir. Lütfen aşağıdaki örneğe bakın.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"blok-getirme-toplu-is-boyutunu-degistirme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#blok-getirme-toplu-is-boyutunu-degistirme"}},[e._v("#")]),e._v(" Blok getirme toplu iş boyutunu değiştirme")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("Dizinleyici zinciri ilk dizine aldığında, tek blokları getirmek performansı önemli ölçüde düşürecektir. Getirilen blok sayısını ayarlamak için toplu iş boyutunu artırmak genel işlem süresini azaltır. Geçerli varsayılan toplu iş boyutu 100'dür.")]),e._v(" "),s("h4",{attrs:{id:"yerel-mod"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yerel-mod"}},[e._v("#")]),e._v(" Yerel mod")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("Hata ayıklama amacıyla, kullanıcılar düğümü yerel modda çalıştırabilir. Yerel modele geçiş, varsayılan şemada postgres tabloları "),s("code",[e._v("public")]),e._v(" oluşturur.")]),e._v(" "),s("p",[e._v("Yerel mod kullanılmazsa, ilk "),s("code",[e._v("subquery_")]),e._v(" ve karşılık gelen proje tablolarına sahip yeni bir Postgres şeması oluşturulur.")]),e._v(" "),s("h4",{attrs:{id:"node-saglıgı-kontrol-ediliyor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-saglıgı-kontrol-ediliyor"}},[e._v("#")]),e._v(" Node sağlığı kontrol ediliyor")]),e._v(" "),s("p",[e._v("Çalışan bir SubQuery node düğümünün durumunu denetlemek ve izlemek için kullanabileceğiniz 2 uç nokta vardır.")]),e._v(" "),s("ul",[s("li",[e._v("Health check endpoint that returns a simple 200 response")]),e._v(" "),s("li",[e._v("Metadata endpoint that includes additional analytics of your running SubQuery node")])]),e._v(" "),s("p",[e._v("Append this to the base URL of your SubQuery node. Eg "),s("code",[e._v("http://localhost:3000/meta")]),e._v(" will return:")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"currentProcessingHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000699")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"currentProcessingTimestamp"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1631517883547")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"targetHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6807295")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"bestHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6807298")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"indexerNodeVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.19.1"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lastProcessedHeight"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1000699")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"lastProcessedTimestamp"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1631517883555")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"uptime"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("41.151789063")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"polkadotSdkVersion"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"5.4.1"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"apiConnected"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" true,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"injectedApiConnected"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" true,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"usingDictionary"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" false,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"chain"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Polkadot"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"specName"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"polkadot"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"genesisHash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0x91b171bb158e2d3848fa23a9f1c25182fb8e20313b2c1eb49219da7a70ce90c3"')]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"blockTime"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6000")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br")])]),s("p",[s("code",[e._v("http://localhost:3000/health")]),e._v(" will return HTTP 200 if successful.")]),e._v(" "),s("p",[e._v("A 500 error will be returned if the indexer is not healthy. This can often be seen when the node is booting up.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"status"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("500")]),e._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"error"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Indexer is not healthy"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("If an incorrect URL is used, a 404 not found error will be returned.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"statusCode"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("404")]),e._v(",\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"message"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Cannot GET /healthy"')]),e._v(",\n"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"error"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Not Found"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("h4",{attrs:{id:"debug-your-project"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debug-your-project"}},[e._v("#")]),e._v(" Debug your project")]),e._v(" "),s("p",[e._v("Use the "),s("a",{attrs:{href:"https://nodejs.org/en/docs/guides/debugging-getting-started/",target:"_blank",rel:"noopener noreferrer"}},[e._v("node inspector"),s("OutboundLink")],1),e._v(" to run the following command.")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("node --inspect-brk "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path to subql-node"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" -f "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("path to subQuery project"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For example:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("node --inspect-brk /usr/local/bin/subql-node -f ~/Code/subQuery/projects/subql-helloworld/\nDebugger listening on ws://127.0.0.1:9229/56156753-c07d-4bbe-af2d-2c7ff4bcc5ad\nFor help, see: https://nodejs.org/en/docs/inspector\nDebugger attached.\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("Then open up the Chrome dev tools, go to Source > Filesystem and add your project to the workspace and start debugging. For more information, check out "),s("a",{attrs:{href:"https://doc.subquery.network/tutorials_examples/debug-projects/",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to debug a SubQuery project"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"sorgu-hizmeti-calıstırma-altql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sorgu-hizmeti-calıstırma-altql-query"}},[e._v("#")]),e._v(" Sorgu Hizmeti Çalıştırma (altql/query)")]),e._v(" "),s("h3",{attrs:{id:"kurma-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kurma-2"}},[e._v("#")]),e._v(" Kurma")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Lütfen "),s("strong",[e._v("DO NOT")]),e._v(", zayıf bağımlılık yönetimi nedeniyle "),s("code",[e._v("yarn global")]),e._v(" kullanımını teşvik ettiğimizi ve bunun da bir hataya yol açabileceğini unutmayın.")]),e._v(" "),s("h3",{attrs:{id:"sorgu-hizmeti-calıstırma"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sorgu-hizmeti-calıstırma"}},[e._v("#")]),e._v(" Sorgu Hizmeti Çalıştırma")]),e._v(" "),s("p",[e._v("export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Projeyi "),s("RouterLink",{attrs:{to:"/tr/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(" proje adıyla aynı olduğundan emin olun. Ayrıca, ortam değişkenlerinin doğru olup olmadığını denetleyin.")],1),e._v(" "),s("p",[e._v("SubQuery hizmetini başarıyla çalıştırdikten sonra tarayıcınızı açın ve "),s("code",[e._v("http://localhost:3000")]),e._v(" gidin. Explorer'da ve sorguya hazır şemada gösterilen bir GraphQL oyun alanı görmeniz gerekir.")])])}),[],!1,null,null,null);a.default=n.exports},799:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/uk/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"using-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-dictionary"}},[e._v("#")]),e._v(" Using a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/uk/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Залежно від конфігурації вашої бази даних Postgres (наприклад, іншого пароля бази даних) переконайтеся, що індексатор ("),s("code",[e._v("subql/node")]),e._v(") та служба запитів ("),s("code",[e._v("subql/query")]),e._v(") можуть встановити з’єднання з нею.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-mode"}},[e._v("#")]),e._v(" Local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Перехід до локальної моделі створює таблиці Postgres у схемі за замовчуванням "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/uk/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports},859:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"running-subquery-locally"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-subquery-locally"}},[e._v("#")]),e._v(" Running SubQuery Locally")]),e._v(" "),s("p",[e._v("This guide works through how to run a local SubQuery node on your infrastructure, which includes both the indexer and query service. Don't want to worry about running your own SubQuery infrastructure? SubQuery provides a "),s("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("managed hosted service"),s("OutboundLink")],1),e._v(" to the community for free. "),s("RouterLink",{attrs:{to:"/zh/publish/publish.html"}},[e._v("Follow our publishing guide")]),e._v(" to see how you can upload your project to "),s("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[e._v("SubQuery Projects"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"using-docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-docker"}},[e._v("#")]),e._v(" Using Docker")]),e._v(" "),s("p",[e._v("An alternative solution is to run a "),s("strong",[e._v("Docker Container")]),e._v(", defined by the "),s("code",[e._v("docker-compose.yml")]),e._v(" file. For a new project that has been just initialised you won't need to change anything here.")]),e._v(" "),s("p",[e._v("Under the project directory run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("docker-compose pull "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" docker-compose up\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("It may take some time to download the required packages ("),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/node")]),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("@subql/query")]),s("OutboundLink")],1),e._v(", and Postgres) for the first time but soon you'll see a running SubQuery node.")]),e._v(" "),s("h2",{attrs:{id:"running-an-indexer-subql-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-an-indexer-subql-node"}},[e._v("#")]),e._v(" Running an Indexer (subql/node)")]),e._v(" "),s("p",[e._v("Requirements:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Postgres"),s("OutboundLink")],1),e._v(" database (version 12 or higher). While the "),s("a",{attrs:{href:"#start-a-local-subquery-node"}},[e._v("SubQuery node")]),e._v(" is indexing the blockchain, the extracted data is stored in an external database instance.")])]),e._v(" "),s("p",[e._v("A SubQuery node is an implementation that extracts substrate-based blockchain data per the SubQuery project and saves it into a Postgres database.")]),e._v(" "),s("h3",{attrs:{id:"installation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/node\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("p",[e._v("Once installed, you can start a node with the following command:")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("subql-node "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"key-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key-commands"}},[e._v("#")]),e._v(" Key Commands")]),e._v(" "),s("p",[e._v("The following commands will assist you to complete the configuration of a SubQuery node and begin indexing. To find out more, you can always run "),s("code",[e._v("--help")]),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"point-to-local-project-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#point-to-local-project-path"}},[e._v("#")]),e._v(" Point to local project path")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"using-a-dictionary"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-dictionary"}},[e._v("#")]),e._v(" Using a Dictionary")]),e._v(" "),s("p",[e._v("Using a full chain dictionary can dramatically speed up the processing of a SubQuery project during testing or during your first index. In some cases, we've seen indexing performance increases of up to 10x.")]),e._v(" "),s("p",[e._v("A full chain dictionary pre-indexes the location of all events and extrinsics within the specific chain and allows your node service to skip to relevant locations when indexing rather than inspecting each block.")]),e._v(" "),s("p",[e._v("You can add the dictionary endpoint in your "),s("code",[e._v("project.yaml")]),e._v(" file (see "),s("RouterLink",{attrs:{to:"/zh/create/manifest.html"}},[e._v("Manifest File")]),e._v("), or specify it at run time using the following command:")],1),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"connect-to-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-database"}},[e._v("#")]),e._v(" Connect to database")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("Depending on the configuration of your Postgres database (e.g. a different database password), please ensure also that both the indexer ("),s("code",[e._v("subql/node")]),e._v(") and the query service ("),s("code",[e._v("subql/query")]),e._v(") can establish a connection to it.")]),e._v(" "),s("h4",{attrs:{id:"specify-a-configuration-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specify-a-configuration-file"}},[e._v("#")]),e._v(" Specify a configuration file")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -c your-project-config.yml\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("This will point the query node to a configuration file which can be in YAML or JSON format. Check out the example below.")]),e._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subquery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" ../../../../subql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("example/extrinsics\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("subqueryName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" extrinsics\nbatchSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("\nlocalMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("h4",{attrs:{id:"change-the-block-fetching-batch-size"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#change-the-block-fetching-batch-size"}},[e._v("#")]),e._v(" Change the block fetching batch size")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("p",[e._v("When the indexer first indexes the chain, fetching single blocks will significantly decrease the performance. Increasing the batch size to adjust the number of blocks fetched will decrease the overall processing time. The current default batch size is 100.")]),e._v(" "),s("h4",{attrs:{id:"local-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#local-mode"}},[e._v("#")]),e._v(" Local mode")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("subql-node -f your-project-path --local\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("For debugging purposes, users can run the node in local mode. Switching to local model will create Postgres tables in the default schema "),s("code",[e._v("public")]),e._v(".")]),e._v(" "),s("p",[e._v("If local mode is not used, a new Postgres schema with the initial "),s("code",[e._v("subquery_")]),e._v(" and corresponding project tables will be created.")]),e._v(" "),s("h2",{attrs:{id:"running-a-query-service-subql-query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-a-query-service-subql-query"}},[e._v("#")]),e._v(" Running a Query Service (subql/query)")]),e._v(" "),s("h3",{attrs:{id:"installation-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installation-2"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# NPM")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -g @subql/query\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("Please note that we "),s("strong",[e._v("DO NOT")]),e._v(" encourage the use of "),s("code",[e._v("yarn global")]),e._v(" due to its poor dependency management which may lead to an errors down the line.")]),e._v(" "),s("h3",{attrs:{id:"running-the-query-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#running-the-query-service"}},[e._v("#")]),e._v(" Running the Query service")]),e._v(" "),s("p",[e._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),e._v(" "),s("p",[e._v("Make sure the project name is the same as the project name when you "),s("RouterLink",{attrs:{to:"/zh/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[e._v("initialize the project")]),e._v(". Also, check the environment variables are correct.")],1),e._v(" "),s("p",[e._v("After running the subql-query service successfully, open your browser and head to "),s("code",[e._v("http://localhost:3000")]),e._v(". You should see a GraphQL playground showing in the Explorer and the schema that is ready to query.")])])}),[],!1,null,null,null);a.default=n.exports}}]);