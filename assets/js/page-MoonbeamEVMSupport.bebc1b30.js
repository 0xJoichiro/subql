(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{492:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},499:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/de/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/de/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},531:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/es/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/es/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},564:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/id/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/id/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},594:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/it/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/it/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},626:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/ja/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/ja/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},658:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/ko/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/ko/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},704:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/ru/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/ru/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},738:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/th/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/th/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},769:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/tr/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/tr/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},807:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/uk/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/uk/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports},839:function(t,e,a){"use strict";a.r(e);var s=a(1),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"moonbeam-evm-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeam-evm-support"}},[t._v("#")]),t._v(" Moonbeam EVM Support")]),t._v(" "),a("p",[t._v("We provide a custom data source processor for Moonbeam's and Moonriver's EVM. This offers a simple way to filter and index both EVM and Substrate activity on Moonbeam's networks within a single SubQuery project.")]),t._v(" "),a("p",[t._v("Supported networks:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Network Name")]),t._v(" "),a("th",[t._v("Websocket Endpoint")]),t._v(" "),a("th",[t._v("Dictionary Endpoint")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Moonbeam")]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])]),t._v(" "),a("td",[a("em",[t._v("Coming soon")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonriver")]),t._v(" "),a("td",[a("code",[t._v("wss://moonbeam-alpha.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonriver-dictionary")])])]),t._v(" "),a("tr",[a("td",[t._v("Moonbase Alpha")]),t._v(" "),a("td",[a("code",[t._v("wss://moonriver.api.onfinality.io/public-ws")])]),t._v(" "),a("td",[a("code",[t._v("https://api.subquery.network/sq/subquery/moonbase-alpha-dictionary")])])])])]),t._v(" "),a("p",[a("strong",[t._v("You can also refer to the "),a("a",{attrs:{href:"https://github.com/subquery/tutorials-moonriver-evm-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("basic Moonriver EVM example project"),a("OutboundLink")],1),t._v(" with an event and call handler.")]),t._v(" This project is also hosted live in the SubQuery Explorer "),a("a",{attrs:{href:"https://explorer.subquery.network/subquery/subquery/moonriver-evm-starter-project",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"getting-started"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting started")]),t._v(" "),a("ol",[a("li",[t._v("Add the custom data source as a dependency "),a("code",[t._v("yarn add @subql/contract-processors")])]),t._v(" "),a("li",[t._v("Add a custom data source as described below")]),t._v(" "),a("li",[t._v("Add handlers for the custom data source to your code")])]),t._v(" "),a("h2",{attrs:{id:"data-source-spec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-spec"}},[t._v("#")]),t._v(" Data Source Spec")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("processor.file")]),t._v(" "),a("td",[a("code",[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")])]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("File reference to the data processor code")])]),t._v(" "),a("tr",[a("td",[t._v("processor.options")]),t._v(" "),a("td",[a("a",{attrs:{href:"#processor-options"}},[t._v("ProcessorOptions")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Options specific to the Moonbeam Processor")])]),t._v(" "),a("tr",[a("td",[t._v("assets")]),t._v(" "),a("td",[a("code",[t._v("{ [key: String]: { file: String }}")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("An object of external asset files")])])])]),t._v(" "),a("h3",{attrs:{id:"processor-options"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#processor-options"}},[t._v("#")]),t._v(" Processor Options")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("abi")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("The ABI that is used by the processor to parse arguments. MUST be a key of "),a("code",[t._v("assets")])])]),t._v(" "),a("tr",[a("td",[t._v("address")]),t._v(" "),a("td",[t._v("String or "),a("code",[t._v("null")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("A contract address where the event is from or call is made to. "),a("code",[t._v("null")]),t._v(" will capture contract creation calls")])])])]),t._v(" "),a("h2",{attrs:{id:"moonbeamcall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamcall"}},[t._v("#")]),t._v(" MoonbeamCall")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/vi/create/mapping/#call-handler"}},[t._v("substrate/CallHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamCall'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Call type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#call-filters"}},[t._v("Call Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"call-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#call-filters"}},[t._v("#")]),t._v(" Call Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("function")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x095ea7b3, approve(address to,uint256 value)")]),t._v(" "),a("td",[t._v("Either "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#FunctionFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Function Signature"),a("OutboundLink")],1),t._v(" strings or the function "),a("code",[t._v("sighash")]),t._v(" to filter the function called on the contract")])]),t._v(" "),a("tr",[a("td",[t._v("from")]),t._v(" "),a("td",[t._v("String")]),t._v(" "),a("td",[t._v("0x6bd193ee6d2104f14f94e2ca6efefae561a4334b")]),t._v(" "),a("td",[t._v("An Ethereum address that sent the transaction")])])])]),t._v(" "),a("h3",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateExtrinsic")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamCall")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-TransactionResponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("TransactionResponse"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("TransactionResponse")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[t._v("It doesn't have "),a("code",[t._v("wait")]),t._v(" and "),a("code",[t._v("confirmations")]),t._v(" properties")]),t._v(" "),a("li",[t._v("A "),a("code",[t._v("success")]),t._v(" property is added to know if the transaction was a success")]),t._v(" "),a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"moonbeamevent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moonbeamevent"}},[t._v("#")]),t._v(" MoonbeamEvent")]),t._v(" "),a("p",[t._v("Works in the same way as "),a("RouterLink",{attrs:{to:"/vi/create/mapping/#event-handler"}},[t._v("substrate/EventHandler")]),t._v(" except with a different handler argument and minor filtering changes.")],1),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Required")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("kind")]),t._v(" "),a("td",[t._v("'substrate/MoonbeamEvent'")]),t._v(" "),a("td",[t._v("Yes")]),t._v(" "),a("td",[t._v("Specifies that this is an Event type handler")])]),t._v(" "),a("tr",[a("td",[t._v("filter")]),t._v(" "),a("td",[a("a",{attrs:{href:"#event-filters"}},[t._v("Event Filter")])]),t._v(" "),a("td",[t._v("No")]),t._v(" "),a("td",[t._v("Filter the data source to execute")])])])]),t._v(" "),a("h3",{attrs:{id:"event-filters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#event-filters"}},[t._v("#")]),t._v(" Event Filters")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Field")]),t._v(" "),a("th",[t._v("Type")]),t._v(" "),a("th",[t._v("Example(s)")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("topics")]),t._v(" "),a("td",[t._v("String array")]),t._v(" "),a("td",[t._v("Transfer(address indexed from,address indexed to,u256 value)")]),t._v(" "),a("td",[t._v("The topics filter follows the Ethereum JSON-PRC log filters, more documentation can be found "),a("a",{attrs:{href:"https://docs.ethers.io/v5/concepts/events/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")])])])]),t._v(" "),a("p",[a("b",[t._v("Note on topics:")]),t._v("\nThere are a couple of improvements from basic log filters:")]),t._v(" "),a("ul",[a("li",[t._v("Topics don't need to be 0 padded")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.ethers.io/v5/api/utils/abi/fragments/#EventFragment",target:"_blank",rel:"noopener noreferrer"}},[t._v("Event Fragment"),a("OutboundLink")],1),t._v(" strings can be provided and automatically converted to their id")])]),t._v(" "),a("h3",{attrs:{id:"handlers-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers-2"}},[t._v("#")]),t._v(" Handlers")]),t._v(" "),a("p",[t._v("Unlike a normal handler you will not get a "),a("code",[t._v("SubstrateEvent")]),t._v(" as the parameter, instead you will get a "),a("code",[t._v("MoonbeamEvent")]),t._v(" which is based on Ethers "),a("a",{attrs:{href:"https://docs.ethers.io/v5/api/providers/types/#providers-Log",target:"_blank",rel:"noopener noreferrer"}},[t._v("Log"),a("OutboundLink")],1),t._v(" type.")]),t._v(" "),a("p",[t._v("Changes from the "),a("code",[t._v("Log")]),t._v(" type:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("args")]),t._v(" is added if the "),a("code",[t._v("abi")]),t._v(" field is provided and the arguments can be successfully parsed")])]),t._v(" "),a("h2",{attrs:{id:"data-source-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-source-example"}},[t._v("#")]),t._v(" Data Source Example")]),t._v(" "),a("p",[t._v("This is an extract from the "),a("code",[t._v("project.yaml")]),t._v(" manifest file.")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/Moonbeam\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startBlock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("752073")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("processor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./node_modules/@subql/contract-processors/dist/moonbeam.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Must be a key of assets")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("abi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" erc20\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Contract address (or recipient if transfer) to filter, if `null` should be for contract creation")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("assets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("erc20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./erc20.abi.json'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./dist/index.js'")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamEvent\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("topics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Transfer(address indexed from"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("address indexed to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("u256 value)\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" handleMoonriverCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" substrate/MoonbeamCall\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## The function can either be the function fragment or signature")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x095ea7b3'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: '0x7ff36ab500000000000000000000000000000000000000000000000000000000'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# function: approve(address,uint256)")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" approve(address to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("uint256 value)\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0x6bd193ee6d2104f14f94e2ca6efefae561a4334b'")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h2",{attrs:{id:"known-limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#known-limitations"}},[t._v("#")]),t._v(" Known Limitations")]),t._v(" "),a("ul",[a("li",[t._v("There is currently no way to query EVM state within a handler")]),t._v(" "),a("li",[t._v("There is no way to get the transaction receipts with call handlers")]),t._v(" "),a("li",[a("code",[t._v("blockHash")]),t._v(" properties are currently left undefined, the "),a("code",[t._v("blockNumber")]),t._v(" property can be used instead")])])])}),[],!1,null,null,null);e.default=r.exports}}]);