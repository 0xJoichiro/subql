(window.webpackJsonp=window.webpackJsonp||[]).push([[190],{758:function(s,e,a){"use strict";a.r(e);var t=a(1),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"การรัน-subquery-ภายในเครื่อง"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การรัน-subquery-ภายในเครื่อง"}},[s._v("#")]),s._v(" การรัน SubQuery ภายในเครื่อง")]),s._v(" "),a("p",[s._v("คู่มือนี้จะศึกษาวิธีการรันโหนด SubQuery บนโครงสร้างพื้นฐานของคุณ ซึ่งรวมถึง indexer และ query service คุณไม่อยากที่จะต้องคอยกังวลเกี่ยวกับการรันโครงสร้างพื้นฐาน SubQuery ของคุณเองใช่หรือไม่? SubQuery ให้บริการ "),a("a",{attrs:{href:"https://explorer.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[s._v("โฮสต์ที่มีการจัดการ"),a("OutboundLink")],1),s._v(" แก่ชุมชนฟรี "),a("RouterLink",{attrs:{to:"/th/publish/publish.html"}},[s._v("ทำตามคู่มือการเผยแพร่ของเรา")]),s._v(" เพื่อดูว่าคุณสามารถอัปโหลดโครงการของคุณไปยัง "),a("a",{attrs:{href:"https://project.subquery.network",target:"_blank",rel:"noopener noreferrer"}},[s._v("SubQuery Projects"),a("OutboundLink")],1),s._v("ได้อย่างไร")],1),s._v(" "),a("h2",{attrs:{id:"การใช้กับ-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การใช้กับ-docker"}},[s._v("#")]),s._v(" การใช้กับ Docker")]),s._v(" "),a("p",[s._v("ทางเลือกหนึ่ง คือการรัน "),a("strong",[s._v("Docker Container")]),s._v(" ซึ่งกำหนดจากไฟล์ "),a("code",[s._v("docker-compose.yml")]),s._v(" สำหรับโปรเจ็กต์ใหม่ที่เพิ่งเริ่มต้น คุณไม่จำเป็นต้องเปลี่ยนแปลงอะไรในส่วนนี้")]),s._v(" "),a("p",[s._v("ภายใต้ไดเร็กทอรีของโปรเจ็กต์ ให้รันคำสั่งต่อไปนี้:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker-compose pull "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" docker-compose up\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("อาจต้องใช้เวลาสักครู่ในการดาวน์โหลดแพ็คเกจที่จำเป็น ("),a("a",{attrs:{href:"https://www.npmjs.com/package/@subql/node",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("@subql/node")]),a("OutboundLink")],1),s._v(", "),a("a",{attrs:{href:"https://www.npmjs.com/package/@subql/query",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("@subql/query")]),a("OutboundLink")],1),s._v(" และ Postgres) สำหรับครั้งแรก แต่ในไม่ช้าคุณจะเห็นการทำงานของโหนด SubQuery")]),s._v(" "),a("h2",{attrs:{id:"การรัน-indexer-subql-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การรัน-indexer-subql-node"}},[s._v("#")]),s._v(" การรัน Indexer (subql/node)")]),s._v(" "),a("p",[s._v("สิ่งที่ต้องมี:")]),s._v(" "),a("ul",[a("li",[s._v("ฐานข้อมูล "),a("a",{attrs:{href:"https://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Postgres"),a("OutboundLink")],1),s._v(" (เวอร์ชัน 12 ขึ้นไป) ในขณะที่ "),a("a",{attrs:{href:"#start-a-local-subquery-node"}},[s._v("โหนด SubQuery")]),s._v(" กำลังทำการ index บล็อกเชน ข้อมูลที่ออกมาจะถูกเก็บไว้ในอินสแตนซ์ของฐานข้อมูลภายนอก")])]),s._v(" "),a("p",[s._v("โหนด SubQuery เป็นการทำงานที่ดึงข้อมูลบล็อกเชนที่ใช้ substrate ตามโปรเจ็กต์ SubQuery และบันทึกลงในฐานข้อมูล Postgres")]),s._v(" "),a("h3",{attrs:{id:"การติดตั้ง"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การติดตั้ง"}},[s._v("#")]),s._v(" การติดตั้ง")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# NPM")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -g @subql/node\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("โปรดทราบว่าเรา "),a("strong",[s._v("ไม่")]),s._v(" สนับสนุนให้ใช้ "),a("code",[s._v("yarn global")]),s._v(" เนื่องจากการจัดการ dependency ที่ไม่ดี ซึ่งอาจนำไปสู่ข้อผิดพลาดได้")]),s._v(" "),a("p",[s._v("เมื่อติดตั้งแล้ว คุณสามารถเริ่มโหนดด้วยคำสั่งต่อไปนี้:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("subql-node "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("command"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"คําสั่งที่สําคัญ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#คําสั่งที่สําคัญ"}},[s._v("#")]),s._v(" คำสั่งที่สำคัญ")]),s._v(" "),a("p",[s._v("คำสั่งต่อไปนี้จะช่วยคุณในการตั้งค่าโหนด SubQuery ให้เสร็จสมบูรณ์และเริ่มการ index หากต้องการข้อมูลเพิ่มเติม คุณสามารถรันคำสั่ง "),a("code",[s._v("--help")]),s._v(" ได้ตลอดเวลา")]),s._v(" "),a("h4",{attrs:{id:"ชี้ไปที่-local-path-ของโปรเจ็กต์"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ชี้ไปที่-local-path-ของโปรเจ็กต์"}},[s._v("#")]),s._v(" ชี้ไปที่ local path ของโปรเจ็กต์")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subql-node -f your-project-path\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"การใช้-dictionary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การใช้-dictionary"}},[s._v("#")]),s._v(" การใช้ Dictionary")]),s._v(" "),a("p",[s._v("การใช้ full chain dictionary สามารถเร่งการประมวลผลโปรเจ็กต์ SubQuery ได้อย่างมาก ทั้งในระหว่างการทดสอบหรือระหว่างการ index ครั้งแรกของคุณ ในบางกรณี เราพบว่าประสิทธิภาพการ index เพิ่มขึ้นถึง 10 เท่า")]),s._v(" "),a("p",[s._v("chain dictionary แบบเต็มรูปแบบจะทำการ index ข้อมูลตำแหน่งเหตุการณ์และปัจจัยภายนอกทั้งหมดที่เกิดขึ้นภายในแต่ละเฉพาะ chain ไว้ล่วงหน้า ช่วยให้โหนดของคุณสามารถข้ามไปยังตำแหน่งที่เกี่ยวข้องเมื่อมีการ index แทนที่จะตรวจสอบทีละบล็อก")]),s._v(" "),a("p",[s._v("คุณสามารถเพิ่ม dictionary endpoint ในไฟล์ "),a("code",[s._v("project.yaml")]),s._v(" ของคุณ (ดู "),a("RouterLink",{attrs:{to:"/th/create/manifest.html"}},[s._v("ไฟล์ Manifest")]),s._v(") หรือสามารถระบุในขณะรันไทม์โดยใช้คำสั่งต่อไปนี้:")],1),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subql-node --network-dictionary=https://api.subquery.network/sq/subquery/dictionary-polkadot\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("RouterLink",{attrs:{to:"/th/tutorials_examples/dictionary.html"}},[s._v("อ่านเพิ่มเติมเกี่ยวกับวิธีการทำงานของ SubQuery Dictionary")])],1),s._v(" "),a("h4",{attrs:{id:"การเชื่อมต่อกับฐานข้อมูล"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การเชื่อมต่อกับฐานข้อมูล"}},[s._v("#")]),s._v(" การเชื่อมต่อกับฐานข้อมูล")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("export DB_USER=postgres\nexport DB_PASS=postgres\nexport DB_DATABASE=postgres\nexport DB_HOST=localhost\nexport DB_PORT=5432\nsubql-node -f your-project-path \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("ซึ่งจะขึ้นอยู่กับการกำหนดค่าฐานข้อมูล Postgres ของคุณด้วย (เช่น รหัสผ่านของฐานข้อมูลอื่น), โปรดตรวจสอบด้วยว่าทั้ง indexer ("),a("code",[s._v("subql/node")]),s._v(") และบริการสืบค้น ("),a("code",[s._v("subql/query")]),s._v(") สามารถสร้างการเชื่อมต่อกับฐานข้อมูลได้")]),s._v(" "),a("h4",{attrs:{id:"ระบุไฟล์สําหรับกําหนดค่า"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ระบุไฟล์สําหรับกําหนดค่า"}},[s._v("#")]),s._v(" ระบุไฟล์สำหรับกำหนดค่า")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subql-node -c your-project-config.yml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("สิ่งนี้จะชี้โหนดการสืบค้นไปยังไฟล์การกำหนดค่าซึ่งจะอยู่ในรูปแบบไฟล์ YAML หรือ JSON Check out the example below.")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("subquery")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ../../../../subql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("example/extrinsics\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("subqueryName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" extrinsics\nbatchSize"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nlocalMode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"การเปลี่ยน-batch-size-ในการ-fetch-บล็อค"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การเปลี่ยน-batch-size-ในการ-fetch-บล็อค"}},[s._v("#")]),s._v(" การเปลี่ยน batch size ในการ fetch บล็อค")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subql-node -f your-project-path --batch-size 200\n\nResult:\n[IndexerManager] fetch block [203, 402]\n[IndexerManager] fetch block [403, 602]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("เมื่อ indexer ทำการ index chain ในครั้งแรก การ fetch ทีละบล็อกจะลดประสิทธิภาพการทำงานลงอย่างมาก การเพิ่ม batch size เพื่อปรับจำนวนบล็อคที่ fetch จะลดเวลาดำเนินการโดยรวมได้ batch size เริ่มต้นในปัจจุบันคือ 100")]),s._v(" "),a("h4",{attrs:{id:"การรันในโหมด-local"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การรันในโหมด-local"}},[s._v("#")]),s._v(" การรันในโหมด local")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subql-node -f your-project-path --local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("เพื่อจุดประสงค์ในการ debug ผู้ใช้สามารถเรียกใช้โหนดในโหมด local ได้ การเปลี่ยนไปใช้โหมด local จะสร้างตาราง Postgres ใน "),a("code",[s._v("public")]),s._v(" ซึ่งเป็น default schema")]),s._v(" "),a("p",[s._v("หากไม่ได้ใช้โหมด local, Postgres schema ใหม่ที่มี "),a("code",[s._v("subquery_")]),s._v(" เริ่มต้นและตารางโปรเจ็กต์ที่เกี่ยวข้องจะถูกสร้างขึ้น")]),s._v(" "),a("h4",{attrs:{id:"ตรวจสอบสถานะความสมบูรณ์ของโหนดของคุณ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ตรวจสอบสถานะความสมบูรณ์ของโหนดของคุณ"}},[s._v("#")]),s._v(" ตรวจสอบสถานะความสมบูรณ์ของโหนดของคุณ")]),s._v(" "),a("p",[s._v("มีปลายทาง 2 endpoints ที่คุณสามารถใช้ตรวจสอบและมอนิเตอร์ความสมบูรณ์ของโหนด SubQuery ที่ทำงานอยู่")]),s._v(" "),a("ul",[a("li",[s._v("Health check endpoint ที่ส่งคืนค่า response 200 อย่างง่าย")]),s._v(" "),a("li",[s._v("Metadata endpoint ที่รวมการวิเคราะห์เพิ่มเติมเกี่ยวกับโหนด SubQuery ของคุณที่กำลังทำงานอยู่")])]),s._v(" "),a("p",[s._v("เพิ่มสิ่งนี้ไปกับ URL พื้นฐานของโหนด SubQuery ของคุณ ตัวอย่างเช่น"),a("code",[s._v("http://localhost:3000/meta")]),s._v(" จะส่งคืนค่า:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"currentProcessingHeight"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000699")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"currentProcessingTimestamp"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1631517883547")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"targetHeight"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6807295")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bestHeight"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6807298")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indexerNodeVersion"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.19.1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lastProcessedHeight"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000699")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lastProcessedTimestamp"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1631517883555")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uptime"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41.151789063")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"polkadotSdkVersion"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5.4.1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apiConnected"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"injectedApiConnected"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"usingDictionary"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"chain"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Polkadot"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"specName"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"polkadot"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"genesisHash"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0x91b171bb158e2d3848fa23a9f1c25182fb8e20313b2c1eb49219da7a70ce90c3"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blockTime"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("code",[s._v("http://localhost:3000/health")]),s._v(" จะคืนค่า HTTP 200 ถ้าสำเร็จ")]),s._v(" "),a("p",[s._v("ค่า 500 error จะถูกส่งเมื่อ indexer ไม่สมบูรณ์ ซึ่งมักจะเห็นได้เมื่อโหนดกำลังทำการบูทอัพ")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Indexer is not healthy"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("หากใช้ URL ที่ไม่ถูกต้อง ข้อผิดพลาด 404 not found จะถูกส่งกลับมา")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"statusCode"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Cannot GET /healthy"')]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Not Found"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"การ-debug-โปรเจ็กต์ของคุณ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การ-debug-โปรเจ็กต์ของคุณ"}},[s._v("#")]),s._v(" การ debug โปรเจ็กต์ของคุณ")]),s._v(" "),a("p",[s._v("ใช้ "),a("a",{attrs:{href:"https://nodejs.org/en/docs/guides/debugging-getting-started/",target:"_blank",rel:"noopener noreferrer"}},[s._v("node inspector"),a("OutboundLink")],1),s._v(" เพื่อเรียกใช้คำสั่งต่อไปนี้")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("node --inspect-brk "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path to subql-node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("path to subQuery project"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ยกตัวอย่างเช่น:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("node --inspect-brk /usr/local/bin/subql-node -f ~/Code/subQuery/projects/subql-helloworld/\nDebugger listening on ws://127.0.0.1:9229/56156753-c07d-4bbe-af2d-2c7ff4bcc5ad\nFor help, see: https://nodejs.org/en/docs/inspector\nDebugger attached.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("จากนั้นเปิดเครื่องมือ Chrome dev ไปที่ Source > Filesystem และเพิ่มโปรเจ็กต์ของคุณลงในเวิร์กสเปซ แล้วเริ่มการ debug ดูรายละเอียดเพิ่มเติมได้ที่ "),a("a",{attrs:{href:"https://doc.subquery.network/tutorials_examples/debug-projects/",target:"_blank",rel:"noopener noreferrer"}},[s._v("วิธี debug โปรเจ็กต์ SubQuery"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"การรัน-query-service-subql-query"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การรัน-query-service-subql-query"}},[s._v("#")]),s._v(" การรัน Query Service (subql/query)")]),s._v(" "),a("h3",{attrs:{id:"การติดตั้ง-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การติดตั้ง-2"}},[s._v("#")]),s._v(" การติดตั้ง")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# NPM")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -g @subql/query\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("โปรดทราบว่าเรา "),a("strong",[s._v("ไม่")]),s._v(" สนับสนุนให้ใช้ "),a("code",[s._v("yarn global")]),s._v(" เนื่องจากการจัดการ dependency ที่ไม่ดี ซึ่งอาจนำไปสู่ข้อผิดพลาดได้")]),s._v(" "),a("h3",{attrs:{id:"การรัน-query-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#การรัน-query-service"}},[s._v("#")]),s._v(" การรัน Query service")]),s._v(" "),a("p",[s._v("``` export DB_HOST=localhost subql-query --name <project_name> --playground ````")]),s._v(" "),a("p",[s._v("ตรวจสอบให้แน่ใจว่าชื่อโปรเจ็กต์นี้ตรงกับชื่อโปรเจ็กต์เมื่อคุณ "),a("RouterLink",{attrs:{to:"/th/quickstart/quickstart.html#initialise-the-starter-subquery-project"}},[s._v("เริ่มต้นโปรเจ็กต์")]),s._v(" ตรวจสอบ environment variables ด้วยว่าถูกต้องหรือไม่")],1),s._v(" "),a("p",[s._v("หลังจากรัน service subql-query สำเร็จแล้ว ให้เปิดเบราว์เซอร์ของคุณ แล้วไปที่ "),a("code",[s._v("http://localhost:3000")]),s._v(" คุณควรเห็น GraphQL playground แสดงใน Explorer และมี schema ที่พร้อมสำหรับการสืบค้น")])])}),[],!1,null,null,null);e.default=n.exports}}]);